{"version":3,"file":"setup.min.js","mappings":"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","sources":["webpack://woocommerce-retailer-plugin/./assets/src/setup.js"],"sourcesContent":["var setupConfig = (function() {\n    for (var key in window) {\n        if (window.hasOwnProperty(key) && key.endsWith('_ajax') && typeof window[key] === 'object' && window[key].retailer_slug) {\n            return window[key];\n        }\n    }\n    throw new Error('Retailer configuration not found. Please ensure constants.php is properly configured.');\n})();\n\nfunction getSelector(identifier) {\n    return '#' + setupConfig.retailer_slug + '-' + identifier;\n}\n\nfunction getClassName(identifier) {\n    return '.' + setupConfig.retailer_slug + '-' + identifier;\n}\n\nfunction getActionName(action) {\n    return setupConfig.ajax_action_prefix + action;\n}\n\nfunction formatDebugInfo(debug) {\n    if (!debug) return '';\n\n    var html = '<div class=\"retailer-debug-info\">';\n    html += '<h4>Debug Information:</h4>';\n\n    if (debug.endpoint) {\n        html += '<p><strong>Endpoint:</strong> ' + debug.endpoint + '</p>';\n    }\n\n    if (debug.response_code) {\n        html += '<p><strong>Response Code:</strong> ' + debug.response_code + '</p>';\n    }\n\n    if (debug.request_data) {\n        html += '<p><strong>Request Data:</strong></p>';\n        html += '<pre class=\"debug-json\">' + JSON.stringify(debug.request_data, null, 2) + '</pre>';\n    }\n\n    if (debug.raw_response) {\n        html += '<p><strong>Raw Response:</strong></p>';\n        html += '<pre class=\"debug-json\">' + debug.raw_response + '</pre>';\n    }\n\n    if (debug.parsed_response) {\n        html += '<p><strong>Parsed Response:</strong></p>';\n        html += '<pre class=\"debug-json\">' + JSON.stringify(debug.parsed_response, null, 2) + '</pre>';\n    }\n\n    if (debug.error) {\n        html += '<p><strong>Error:</strong> ' + debug.error + '</p>';\n    }\n\n    html += '</div>';\n    return html;\n}\n\njQuery(document).ready(function($) {\n    $(getSelector('setup-form')).on('submit', function(e) {\n        e.preventDefault();\n\n        var formData = $(this).serialize();\n        var submitButton = $(this).find('button[type=\"submit\"]');\n        var messagesContainer = $(getSelector('messages'));\n\n        submitButton.prop('disabled', true).text('Submitting...');\n        messagesContainer.empty();\n\n        $.ajax({\n            url: setupConfig.ajax_url,\n            type: 'POST',\n            data: formData + '&action=' + getActionName('submit_setup') + '&nonce=' + setupConfig.nonce,\n            dataType: 'json',\n            success: function(response) {\n                if (response.success) {\n                    messagesContainer.html('<div class=\"notice success\"><p>' + response.data + '</p></div>');\n                    setTimeout(function() {\n                        window.location.href = window.location.href + '&step=2';\n                    }, 2000);\n                } else {\n                    var errorHtml = '<div class=\"notice error\"><p>' + (response.data.message || response.data) + '</p>';\n                    if (response.data.debug) {\n                        errorHtml += formatDebugInfo(response.data.debug);\n                    }\n                    errorHtml += '</div>';\n                    messagesContainer.html(errorHtml);\n                    submitButton.prop('disabled', false).text('Submit & Verify Email');\n                }\n            },\n            error: function() {\n                messagesContainer.html('<div class=\"notice error\"><p>An error occurred. Please try again.</p></div>');\n                submitButton.prop('disabled', false).text('Submit & Verify Email');\n            }\n        });\n    });\n\n    $(getSelector('verify-form')).on('submit', function(e) {\n        e.preventDefault();\n\n        var formData = $(this).serialize();\n        var submitButton = $(this).find('button[type=\"submit\"]');\n        var messagesContainer = $(getSelector('messages'));\n\n        submitButton.prop('disabled', true).text('Verifying...');\n        messagesContainer.empty();\n\n        $.ajax({\n            url: setupConfig.ajax_url,\n            type: 'POST',\n            data: formData + '&action=' + getActionName('verify_email') + '&nonce=' + setupConfig.nonce,\n            dataType: 'json',\n            success: function(response) {\n\n                if (response.success) {\n                    var responseData = response.data;\n\n                    if (typeof responseData === 'object' && responseData.redirect_url) {\n                        messagesContainer.html('<div class=\"notice success\"><p>' + responseData.message + '</p></div>');\n\n                        setTimeout(function() {\n                            window.location.href = responseData.redirect_url;\n                        }, 1500);\n                    }\n                } else {\n                    var errorHtml = '<div class=\"notice error\"><p>' + (response.data.message || response.data) + '</p>';\n                    if (response.data.debug) {\n                        errorHtml += formatDebugInfo(response.data.debug);\n                    }\n                    errorHtml += '</div>';\n                    messagesContainer.html(errorHtml);\n                    submitButton.prop('disabled', false).text('Verify & Authorize WooCommerce');\n                }\n            },\n            error: function() {\n                messagesContainer.html('<div class=\"notice error\"><p>An error occurred. Please try again.</p></div>');\n                submitButton.prop('disabled', false).text('Verify & Authorize WooCommerce');\n            }\n        });\n    });\n\n    $(getSelector('complete-form')).on('submit', function(e) {\n        e.preventDefault();\n\n        var submitButton = $(this).find('button[type=\"submit\"]');\n        var messagesContainer = $(getSelector('messages'));\n\n        submitButton.prop('disabled', true).text('Completing Registration...');\n        messagesContainer.empty();\n\n        $.ajax({\n            url: setupConfig.ajax_url,\n            type: 'POST',\n            data: {\n                action: getActionName('complete_registration'),\n                nonce: setupConfig.nonce\n            },\n            dataType: 'json',\n            success: function(response) {\n                if (response.success) {\n                    var message = (typeof response.data === 'object' && response.data.message) ? response.data.message : response.data;\n                    messagesContainer.html('<div class=\"notice success\"><p>' + message + '</p></div>');\n\n                    setTimeout(function() {\n                        if (response.data && response.data.dashboard_url) {\n                            window.location.href = response.data.dashboard_url;\n                        } else {\n                            window.location.href = setupConfig.admin_url + 'admin.php?page=' + setupConfig.retailer_slug + '-home';\n                        }\n                    }, 3000);\n                } else {\n                    messagesContainer.html('<div class=\"notice error\"><p>' + response.data + '</p></div>');\n                    submitButton.prop('disabled', false).text('Continue & Complete Registration');\n                }\n            },\n            error: function() {\n                messagesContainer.html('<div class=\"notice error\"><p>An error occurred. Please try again.</p></div>');\n                submitButton.prop('disabled', false).text('Continue & Complete Registration');\n            }\n        });\n    });\n\n    // Auto-start registration completion when user lands on completion page\n    // This detects if we're on step 2 with complete_registration=1 parameter\n    if ($('#step-2-registration').length > 0) {\n        var urlParams = new URLSearchParams(window.location.search);\n        if (urlParams.get('complete_registration') === '1') {\n\n            $('#step-2-registration ' + getClassName('step-status'))\n                .removeClass('pending')\n                .addClass('in-progress');\n\n            setTimeout(function() {\n                $.ajax({\n                    url: setupConfig.ajax_url,\n                    type: 'POST',\n                    data: {\n                        action: getActionName('complete_registration'),\n                        nonce: setupConfig.nonce\n                    },\n                    dataType: 'json',\n                    success: function(response) {\n\n                        if (response.success) {\n                            $('#step-2-registration ' + getClassName('step-status'))\n                                .removeClass('in-progress')\n                                .addClass('completed');\n\n                            $('#step-2-registration .step-description')\n                                .text('Registration completed successfully!');\n\n                            $(getSelector('messages')).html(\n                                '<div class=\"notice notice-success\"><p>Registration completed successfully! Your store is now connected to ' + setupConfig.retailer_slug.charAt(0).toUpperCase() + setupConfig.retailer_slug.slice(1) + '.</p></div>'\n                            );\n\n                            setTimeout(function() {\n                                if (response.data && response.data.dashboard_url) {\n                                    window.location.href = response.data.dashboard_url;\n                                } else {\n                                    window.location.href = setupConfig.admin_url + 'admin.php?page=' + setupConfig.retailer_slug + '-home';\n                                }\n                            }, 3000);\n                        } else {\n                            $('#step-2-registration ' + getClassName('step-status'))\n                                .removeClass('in-progress')\n                                .addClass('error');\n\n                            $('#step-2-registration .step-description')\n                                .text('Registration failed - please try again');\n\n                            var errorHtml = '<div class=\"notice notice-error\"><p>' + (response.data.message || response.data) + '</p>';\n                            if (response.data && response.data.debug) {\n                                errorHtml += formatDebugInfo(response.data.debug);\n                            }\n                            errorHtml += '</div>';\n                            $(getSelector('messages')).html(errorHtml);\n\n                            $(getSelector('complete-form')).show();\n                        }\n                    },\n                    error: function(xhr, status, error) {\n\n                        $('#step-2-registration ' + getClassName('step-status'))\n                            .removeClass('in-progress')\n                            .addClass('error');\n\n                        $('#step-2-registration .step-description')\n                            .text('Connection error - please try again');\n\n                        $(getSelector('messages')).html(\n                            '<div class=\"notice notice-error\"><p>Connection error occurred. Please try again.</p></div>'\n                        );\n\n                        $(getSelector('complete-form')).show();\n                    }\n                });\n            }, 1000);\n        }\n    }\n});\n"],"names":["setupConfig","key","window","hasOwnProperty","endsWith","retailer_slug","Error","getSelector","identifier","getClassName","getActionName","action","ajax_action_prefix","formatDebugInfo","debug","html","endpoint","response_code","request_data","JSON","stringify","raw_response","parsed_response","error","jQuery","document","ready","$","on","e","preventDefault","formData","this","serialize","submitButton","find","messagesContainer","prop","text","empty","ajax","url","ajax_url","type","data","nonce","dataType","success","response","setTimeout","location","href","errorHtml","message","responseData","redirect_url","dashboard_url","admin_url","length","URLSearchParams","search","get","removeClass","addClass","charAt","toUpperCase","slice","show","xhr","status"],"ignoreList":[],"sourceRoot":""}