{"version":3,"file":"dashboard.min.js","mappings":"YAAA,IAAIA,EAAmB,WACnB,IAAK,IAAIC,KAAOC,OACZ,GAAIA,OAAOC,eAAeF,IAAQA,EAAIG,SAAS,eAAwC,iBAAhBF,OAAOD,IAAqBC,OAAOD,GAAKI,cAC3G,OAAOH,OAAOD,GAGtB,MAAM,IAAIK,MAAM,wFACpB,CAPuB,GAavBC,OAAOC,UAAUC,MAAM,SAASC,GAC5B,IALiBC,EAKbC,EAASJ,SAASK,eAAe,kBACjCC,EAAkBJ,GANLC,EAMmB,mBAL7B,IAAMX,EAAgBK,cAAgB,IAAMM,IAOnD,GAAKC,EAAL,CAKIE,EAAgBC,QAAQ,8DAAgEf,EAAgBK,cAAcW,OAAO,GAAGC,cAAgBjB,EAAgBK,cAAca,MAAM,GAAK,qBAS7LN,EAAOO,OAAS,WAEZ,IACI,IAAIC,EAAYR,EAAOS,iBAAmBT,EAAOU,cAAcd,SAC/D,GAAIY,GAAaA,EAAUG,MACiB,IAApCH,EAAUG,KAAKC,UAAUC,OAEzB,YADAX,EAAgBY,KAAK,gHAAkHd,EAAOe,IAAM,8EAIhK,CAAE,MAAOC,GACT,CAEAC,IAEA,IACI,GAAIjB,EAAOU,cAAe,CACtB,IAAIQ,EAAe,IAAIC,IAAI/B,EAAgBgC,YAAYC,OAEvD,IACIrB,EAAOU,cAAcY,YAAY,CAC7BC,KAAM,eACNC,OAAQ,sBACTN,EACP,CAAE,MAAOO,GAEL,IACIzB,EAAOU,cAAcY,YAAY,CAC7BC,KAAM,eACNC,OAAQ,sBACT,IACP,CAAE,MAAOE,GACT,CACJ,CAEJ,CAGJ,CAAE,MAAOV,GAET,CACJ,EAEAhB,EAAO2B,QAAU,WACbV,IACAf,EAAgBY,KAAK,0GACzB,EAEAxB,OAAOsC,iBAAiB,UAAW,SAASC,GACxC,IAAIC,EAAgB,IAAIX,IAAI/B,EAAgBgC,YAAYC,OACxD,GAAIQ,EAAMR,SAAWS,EAArB,CAIA,IAAIC,EAAOF,EAAME,KAEjB,OAAOA,EAAKR,MACR,IAAK,eACDN,IACA,MAEJ,IAAK,gBACGc,EAAKC,QAAUD,EAAKC,OAAS,KAC7BlC,EAAEE,GAAQiC,QAAQ,CACdD,OAAQE,KAAKC,IAAIJ,EAAKC,OAAQlC,EAAER,QAAQ0C,SAAW,KAAO,MAC3D,KAEP,MAEJ,IAAK,QAED9B,EAAgBC,QACZ,6DACe4B,EAAKK,QADpB,oEAKJ,MAEJ,IAAK,UACDlC,EAAgBC,QACZ,wDACQ4B,EAAKK,QADb,oEAKJ,MAEJ,IAAK,SACD9C,OAAO+C,SAASC,SArCxB,CA0CJ,GAAG,GAEHxC,EAAEF,UAAU2C,GAAG,QAAS,kBAAmB,WACvCzC,EAAE0C,MAAMC,QAAQ,WAAWC,SAC/B,GAEAC,WAAW,WACP7C,EAAE,0BAA0B4C,SAChC,EAAG,KAEHC,WAAW,WACH7C,EAAE,mBAAmBe,OAAS,IAC9Bf,EAAE,oBAAoB8C,OACtB3B,IAER,EAAG,KAEH,IACI4B,EAAoB,mBAExB,GAAyC,MAHzB,IAAIC,gBAAgBxD,OAAO+C,SAASU,QAGtCC,IAAIH,GAA4B,CAC1C3C,EAAgBC,QACZ,2LAMJ,IAAI8C,EAAW3D,OAAO+C,SAASa,KAAKC,MAAM,KAAK,GAC3CC,EAAS,IAAIN,gBAAgBxD,OAAO+C,SAASU,QACjDK,EAAOC,OAAOR,GACd,IAAIS,EAAcF,EAAOG,WAErBD,IACAL,GAAY,IAAMK,GAGtBhE,OAAOkE,QAAQC,aAAa,CAAC,EAAG7D,SAAS8D,MAAOT,EACpD,CAhJA,CAMA,SAAShC,IACLnB,EAAE,mBAAmB6D,QACzB,CAyIJ,E","sources":["webpack://woocommerce-retailer-plugin/./assets/src/dashboard.js"],"sourcesContent":["var dashboardConfig = (function() {\n    for (var key in window) {\n        if (window.hasOwnProperty(key) && key.endsWith('_dashboard') && typeof window[key] === 'object' && window[key].retailer_slug) {\n            return window[key];\n        }\n    }\n    throw new Error('Retailer configuration not found. Please ensure constants.php is properly configured.');\n})();\n\nfunction getSelector(identifier) {\n    return '#' + dashboardConfig.retailer_slug + '-' + identifier;\n}\n\njQuery(document).ready(function($) {\n    var iframe = document.getElementById('shopwoo-iframe');\n    var iframeContainer = $(getSelector('iframe-container'));\n\n    if (!iframe) {\n        return;\n    }\n\n    function showLoading() {\n        iframeContainer.prepend('<div class=\"iframe-loading\" id=\"iframe-loading\"><p>Loading ' + dashboardConfig.retailer_slug.charAt(0).toUpperCase() + dashboardConfig.retailer_slug.slice(1) + ' App...</p></div>');\n    }\n\n    function hideLoading() {\n        $('#iframe-loading').remove();\n    }\n\n    showLoading();\n\n    iframe.onload = function() {\n\n        try {\n            var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;\n            if (iframeDoc && iframeDoc.body) {\n                if (iframeDoc.body.innerHTML.length === 0) {\n                    iframeContainer.html('<div class=\"notice notice-error\"><p><strong>Dashboard blocked by browser security.</strong><br>Try: <a href=\"' + iframe.src + '\" target=\"_blank\">Open in new tab</a> or disable browser shields.</p></div>');\n                    return;\n                }\n            }\n        } catch (e) {\n        }\n\n        hideLoading();\n\n        try {\n            if (iframe.contentWindow) {\n                var targetOrigin = new URL(dashboardConfig.iframe_url).origin;\n\n                try {\n                    iframe.contentWindow.postMessage({\n                        type: 'parent_ready',\n                        source: 'woocommerce_plugin'\n                    }, targetOrigin);\n                } catch (postMessageError) {\n\n                    try {\n                        iframe.contentWindow.postMessage({\n                            type: 'parent_ready',\n                            source: 'woocommerce_plugin'\n                        }, '*');\n                    } catch (wildcardError) {\n                    }\n                }\n\n            } else {\n                console.error('Iframe contentWindow not available');\n            }\n        } catch (e) {\n            console.error('Error in iframe onload handler:', e);\n        }\n    };\n\n    iframe.onerror = function() {\n        hideLoading();\n        iframeContainer.html('<div class=\"notice notice-error\"><p>Failed to load dashboard. Please try refreshing the page.</p></div>');\n    };\n\n    window.addEventListener('message', function(event) {\n        var allowedOrigin = new URL(dashboardConfig.iframe_url).origin;\n        if (event.origin !== allowedOrigin) {\n            return;\n        }\n\n        var data = event.data;\n\n        switch(data.type) {\n            case 'iframe_ready':\n                hideLoading();\n                break;\n\n            case 'resize_iframe':\n                if (data.height && data.height > 400) {\n                    $(iframe).animate({\n                        height: Math.min(data.height, $(window).height() - 100) + 'px'\n                    }, 300);\n                }\n                break;\n\n            case 'error':\n                console.error('Iframe error:', data.message);\n                iframeContainer.prepend(\n                    '<div class=\"notice notice-error is-dismissible\">' +\n                    '<p>Error: ' + data.message + '</p>' +\n                    '<button type=\"button\" class=\"notice-dismiss\"></button>' +\n                    '</div>'\n                );\n                break;\n\n            case 'success':\n                iframeContainer.prepend(\n                    '<div class=\"notice notice-success is-dismissible\">' +\n                    '<p>' + data.message + '</p>' +\n                    '<button type=\"button\" class=\"notice-dismiss\"></button>' +\n                    '</div>'\n                );\n                break;\n\n            case 'logout':\n                window.location.reload();\n                break;\n\n            default:\n        }\n    }, false);\n\n    $(document).on('click', '.notice-dismiss', function() {\n        $(this).closest('.notice').fadeOut();\n    });\n\n    setTimeout(function() {\n        $('.notice.is-dismissible').fadeOut();\n    }, 5000);\n\n    setTimeout(function() {\n        if ($('#iframe-loading').length > 0) {\n            $('#iframe-fallback').show();\n            hideLoading();\n        }\n    }, 8000);\n\n    var urlParams = new URLSearchParams(window.location.search);\n    var successOAuthParam = 'wc-oauth-success';\n\n    if (urlParams.get(successOAuthParam) === '1') {\n        iframeContainer.prepend(\n            '<div class=\"notice notice-success is-dismissible\">' +\n            '<p>WooCommerce authorization successful! Your store is now connected.</p>' +\n            '<button type=\"button\" class=\"notice-dismiss\"></button>' +\n            '</div>'\n        );\n\n        var cleanUrl = window.location.href.split('?')[0];\n        var params = new URLSearchParams(window.location.search);\n        params.delete(successOAuthParam);\n        var paramString = params.toString();\n\n        if (paramString) {\n            cleanUrl += '?' + paramString;\n        }\n\n        window.history.replaceState({}, document.title, cleanUrl);\n    }\n});\n"],"names":["dashboardConfig","key","window","hasOwnProperty","endsWith","retailer_slug","Error","jQuery","document","ready","$","identifier","iframe","getElementById","iframeContainer","prepend","charAt","toUpperCase","slice","onload","iframeDoc","contentDocument","contentWindow","body","innerHTML","length","html","src","e","hideLoading","targetOrigin","URL","iframe_url","origin","postMessage","type","source","postMessageError","wildcardError","onerror","addEventListener","event","allowedOrigin","data","height","animate","Math","min","message","location","reload","on","this","closest","fadeOut","setTimeout","show","successOAuthParam","URLSearchParams","search","get","cleanUrl","href","split","params","delete","paramString","toString","history","replaceState","title","remove"],"ignoreList":[],"sourceRoot":""}