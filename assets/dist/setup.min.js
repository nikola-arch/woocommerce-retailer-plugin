!function(){var e=function(){for(var e in window)if(window.hasOwnProperty(e)&&e.endsWith("_ajax")&&"object"==typeof window[e]&&window[e].retailer_slug)return window[e];throw new Error("Retailer configuration not found. Please ensure constants.php is properly configured.")}();function t(t){return"#"+e.retailer_slug+"-"+t}function s(t){return"."+e.retailer_slug+"-"+t}function r(t){return e.ajax_action_prefix+t}function a(e){if(!e)return"";var t='<div class="retailer-debug-info">';return t+="<h4>Debug Information:</h4>",e.endpoint&&(t+="<p><strong>Endpoint:</strong> "+e.endpoint+"</p>"),e.response_code&&(t+="<p><strong>Response Code:</strong> "+e.response_code+"</p>"),e.request_data&&(t+="<p><strong>Request Data:</strong></p>",t+='<pre class="debug-json">'+JSON.stringify(e.request_data,null,2)+"</pre>"),e.raw_response&&(t+="<p><strong>Raw Response:</strong></p>",t+='<pre class="debug-json">'+e.raw_response+"</pre>"),e.parsed_response&&(t+="<p><strong>Parsed Response:</strong></p>",t+='<pre class="debug-json">'+JSON.stringify(e.parsed_response,null,2)+"</pre>"),e.error&&(t+="<p><strong>Error:</strong> "+e.error+"</p>"),t+="</div>"}jQuery(document).ready(function(o){(o(t("setup-form")).on("submit",function(s){s.preventDefault();var i=o(this).serialize(),n=o(this).find('button[type="submit"]'),d=o(t("messages"));n.prop("disabled",!0).text("Submitting..."),d.empty(),o.ajax({url:e.ajax_url,type:"POST",data:i+"&action="+r("submit_setup")+"&nonce="+e.nonce,dataType:"json",success:function(e){if(e.success)d.html('<div class="notice success"><p>'+e.data+"</p></div>"),setTimeout(function(){window.location.href=window.location.href+"&step=2"},2e3);else{var t='<div class="notice error"><p>'+(e.data.message||e.data)+"</p>";e.data.debug&&(t+=a(e.data.debug)),t+="</div>",d.html(t),n.prop("disabled",!1).text("Submit & Verify Email")}},error:function(){d.html('<div class="notice error"><p>An error occurred. Please try again.</p></div>'),n.prop("disabled",!1).text("Submit & Verify Email")}})}),o(t("verify-form")).on("submit",function(s){s.preventDefault();var i=o(this).serialize(),n=o(this).find('button[type="submit"]'),d=o(t("messages"));n.prop("disabled",!0).text("Verifying..."),d.empty(),o.ajax({url:e.ajax_url,type:"POST",data:i+"&action="+r("verify_email")+"&nonce="+e.nonce,dataType:"json",success:function(e){if(e.success){var t=e.data;"object"==typeof t&&t.redirect_url&&(d.html('<div class="notice success"><p>'+t.message+"</p></div>"),setTimeout(function(){window.location.href=t.redirect_url},1500))}else{var s='<div class="notice error"><p>'+(e.data.message||e.data)+"</p>";e.data.debug&&(s+=a(e.data.debug)),s+="</div>",d.html(s),n.prop("disabled",!1).text("Verify & Authorize WooCommerce")}},error:function(){d.html('<div class="notice error"><p>An error occurred. Please try again.</p></div>'),n.prop("disabled",!1).text("Verify & Authorize WooCommerce")}})}),o(t("complete-form")).on("submit",function(s){s.preventDefault();var a=o(this).find('button[type="submit"]'),i=o(t("messages"));a.prop("disabled",!0).text("Completing Registration..."),i.empty(),o.ajax({url:e.ajax_url,type:"POST",data:{action:r("complete_registration"),nonce:e.nonce},dataType:"json",success:function(t){if(t.success){var s="object"==typeof t.data&&t.data.message?t.data.message:t.data;i.html('<div class="notice success"><p>'+s+"</p></div>"),setTimeout(function(){t.data&&t.data.dashboard_url?window.location.href=t.data.dashboard_url:window.location.href=e.admin_url+"admin.php?page="+e.retailer_slug+"-home"},3e3)}else i.html('<div class="notice error"><p>'+t.data+"</p></div>"),a.prop("disabled",!1).text("Continue & Complete Registration")},error:function(){i.html('<div class="notice error"><p>An error occurred. Please try again.</p></div>'),a.prop("disabled",!1).text("Continue & Complete Registration")}})}),o("#step-2-registration").length>0)&&("1"===new URLSearchParams(window.location.search).get("complete_registration")&&(o("#step-2-registration "+s("step-status")).removeClass("pending").addClass("in-progress"),setTimeout(function(){o.ajax({url:e.ajax_url,type:"POST",data:{action:r("complete_registration"),nonce:e.nonce},dataType:"json",success:function(r){if(r.success)o("#step-2-registration "+s("step-status")).removeClass("in-progress").addClass("completed"),o("#step-2-registration .step-description").text("Registration completed successfully!"),o(t("messages")).html('<div class="notice notice-success"><p>Registration completed successfully! Your store is now connected to '+e.retailer_slug.charAt(0).toUpperCase()+e.retailer_slug.slice(1)+".</p></div>"),setTimeout(function(){r.data&&r.data.dashboard_url?window.location.href=r.data.dashboard_url:window.location.href=e.admin_url+"admin.php?page="+e.retailer_slug+"-home"},3e3);else{o("#step-2-registration "+s("step-status")).removeClass("in-progress").addClass("error"),o("#step-2-registration .step-description").text("Registration failed - please try again");var i='<div class="notice notice-error"><p>'+(r.data.message||r.data)+"</p>";r.data&&r.data.debug&&(i+=a(r.data.debug)),i+="</div>",o(t("messages")).html(i),o(t("complete-form")).show()}},error:function(e,r,a){o("#step-2-registration "+s("step-status")).removeClass("in-progress").addClass("error"),o("#step-2-registration .step-description").text("Connection error - please try again"),o(t("messages")).html('<div class="notice notice-error"><p>Connection error occurred. Please try again.</p></div>'),o(t("complete-form")).show()}})},1e3)))})}();
//# sourceMappingURL=setup.min.js.map